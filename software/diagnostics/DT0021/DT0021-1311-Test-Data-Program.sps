00010*         DT 0021 - TEST DATA PROGRAM
00020*
00030*
00040*         THIS PROGRAM WRITES TEST
00050*         DATA ON CYLINDER 97 OF THE
00060*         CE DISK PACK FOR 1311
00070*         DISK STORAGE DRIVE
00080*
00090*
00100*         CONTROL ROUTINES
00110*
00120      DORG00402
00140STA   B   *+12,,,        RESTART
00150      RCTY,,,            RETURN CARRIAGE
00160      WATYT1,,,          TYPE TEST NAME
00170*
00180*         TYPE OUT SWITCH SETTINGS
00190*
00200      RCTY,,,            RET CARR
00210      WATYT30,,,         TYPE SW3 ON
00220      RCTY,,,            RETURN CARRIAGE
00230      WATYT4,,,          TYPE SW SETTING
00240      RCTY,,,            RETURN CARRIAGE
00250      WATYT5,,,          TYPE SENSE--OFF
00260      RCTY,,,            RETURN CARRIAGE
00270      WATYT6,,,          TYPE DATA-PROG
00280      H   ,,,            HALT
00290      TFM STA+6,*+12,,   LOAD RESTART
00300*
00310*         REQUEST AND ACCEPT MODULE NO.
00320*
00330      RCTY,,,            RETURN CARRIAGE
00340      WATYT7,,,          ROT MOD NO.
00350      RNTYN,,,           KEY IN NUMBER
00360      BC3 *-12,,,        SW3 ON TYP AGAIN
00370*
00380*         THIS ROUTINE COMPUTES DRIVE
00390*         CODE DIGIT FROM MODULE NO.
00400*         AND LOADS SUB-INST WITH
00410*         DRIVE CODE DIGIT
00420*         AND STORE MATH TABLES
00430*
00440      MM  N,02,10,       MULTIPLY
00450      AM  99,01,8,       ADD 1
00460      TD  M,99,,         RELOAD MOD NO.
00470      TD  S1,M,,         LOAD MOD NO.
00480      TD  S2,M,,         LOAD MOD NO.
00490      TD  S3,M,,         LOAD MOD NO.
00500      TR  TAB,00100,,    STORE MATH TABLES
00510*
00520*         THIS ROUTINE CHECKS THAT
00530*         THE DISK PACK ON STORAGE
00540*         UNIT IS THE CE DISK PACK
00550*
00570      TFM S3+5,00000,,   LOAD SUB-INST
00580      TFM K4+11,CC,,     LOAD INST
00590K3    K   S3,00701,,     SEEK CYLINDER
00600      RN  S3,00702,,     READ A SECTOR
00610      BI  K1,03600,,     ADDRESS CHECK
00620      RCTY,,,            RET CARR
00630      WATYT20,,,         TYPE DO NOT USE
00640      H   ,,,            HALT
00650      B   STA,,11,       START OVER
00660K1    BNF *+48,K1-1,,    CK FOR FLAG
00670      CF  K1-1,,,        CLEAR FLAG
00680      AM  S3+5,20,,      UPDATE NEXT HD
00690      B   K3+12,,,       LOOP BACK
00694      SF  K1-1,,,        SET FLAG
00696      BI  *+12,0600,,    TURN OFF RD CK
00700      CM  S3+3,199,9,    IS LAST CYL
00710      BE  K2,,,          BRCH EQUAL
00730K4    TF  S3+5,99999,,   LOAD SUB-INST
00740      AM  K4+11,05,,     UPDATE INST
00750      B   K3,,,          LOOP BACK
00760*
00770*         THE NEXT ROUTINE SEEKS CYL 97
00780*         IN ORDER TO PUT TEST DATA ON IT
00790*
00800K2    TFM S3+5,19400,,   LOAD SUB-INST
00810      K   S3,00701,,     SEEK CYLINDER 97
00820      BNI *+48,01900,,   ANY DATA CHECK
00830      TFM ERR+18,*-24,,  LOAD RETURN
00840      TFM E1+6,ER8,,     LOAD OPERATION
00850      B   ERR,,,         BRCH TO ER ROUT
00860      RN  S3,00702,,     RD SECTOR
00870      BNI K5,03600,,     ADDRESS CHECK
00880      TFM S3+8,020,9,    CHANGE SECTOR NO.
00890      RN  S3,00706,,     READ TRACK
00900      SF  A3+1,,,        SET FLAG
00910      MM  A3+3,05,10,    COMPUTE CYL
00920      TD  ER22+28,97,,   LOAD ER T/O
00930      TD  ER22+30,98,,   LOAD ER T/O
00940      CF  A3+1,,,        CLEAR FLAG
00950      BC1 *+36,,,        SW 1 ON BYPASS
00960      RCTY,,,            RET CARR
00970      WATYER22,,,        TYPE ERROR
00980      BNC3*+24,,,        SW 3 ON HALT
00990      H   ,,,            HALT
01000      B   K2,,,          TRY AGAIN
01010*
01020*         LOAD TEST DATA INTO AREA A1
01030*
01040K5    TFM S3+8,001,9,    RESET SCTR CNT
01050      SF  TD,,,          SET FLAG
01060      TFM *+30,A1+100,,  INITIALIZE
01070      TFM *+30,A1+1,,    INITIALIZE
01080      TF  99999,TD+99,,  LOAD DATA IN A1
01090      CF  99999,,,       CLEAR FLAG
01100      CM  *-18,A1+2000,, SEE IF DONE
01110      BE  *+48,,,        BRCH IF DONE
01120      AM  *-42,100,,     UPDATE
01130      AM  *-42,100,,     UPDATE
01140      B   *-72,,,        LOOP BACK
01150*
01160*         RESET INDICATORS
01170*
01180      BNI *+156,01900,,  ANY DATA CHECK
01190      BNI *+48,03900,,   ANY FILE
01200      BI  *+12,03600,,   ADRS CK
01210      BI  *+12,03700,,   RL CK
01220      BI  *+12,03800,,   OVFO CK
01230      BI  *+12,00600,,   RD CK
01240      BI  *+12,00700,,   WR CK
01250      BI  *+12,01600,,   MBR-E CK
01260      BI  *+12,01700,,   MBR-O CK
01270      BI  *+12,00800,,   MAR CK
01280      BI  *+12,02100,,   TAS CK
01290      BI  *+12,02200,,   F R CK
01300      BI  *+12,02300,,   A O CK
01310*
01320*         WRITE TRACK OF TEST DATA
01330*
01340      TD  A2-1,GM,,      PUT IN GM
01350      TD  A3-1,GM,,      PUT IN GM
01360      TFM S1+5,19400,,   LOAD SUB-INS.
01370      TFM S2+5,19400,,   LOAD SUB-INST
01380      TFM *+23,TD+1,,    LOAD NEXT INST
01390      TD  A1+1,99999,,   SET UP HD CNTR
01400      AM  *-1,10,,       UPDATE
01410K6    WN  S1,00700,,     WR TK WITH RLC
01420      BNI *+48,01900,,   ANY DATA CHECK
01430      TFM ERR+18,*-24,,  LOAD RETURN
01440      TFM E1+6,ER3,,     LOAD ERROR T/O
01450      B   ERR,,,         CK FOR ERROR
01460*
01470*         READ BACK CHECK
01480*
01490      RN  S1,00701,,     RD BK CK RLC
01500      BNI *+48,01900,,   ANY DATA CHECK
01510      TFM ERR+18,*-24,,  LOAD RETURN
01520      TFM E1+6,ER4,,     LOAD ERROR T/O
01530      B   ERR,,,         BRCH TO ERROR
01540*
01550*         READ DATA INTO AREA A2
01560*
01570      RN  S2,00700,,     RD DISK RLC
01580      BNI *+48,01900,,   ANY DATA CHECK
01590      TFM ERR+18,*-24,,  LOAD RETURN
01600      TFM E1+6,ER5,,     LOAD ERROR T/O
01610      B   ERR,,,         BRCH TO ERROR
01620*
01630*         THIS ROUTINE DOES A PROGRAM
01640*         COMPARE OF DATA READ WITH
01650*         THE DATA THAT WAS WRITTEN
01660*
01670      SF  A1+1,,,        SET FLAG
01680      SF  A2+1,,,        SET FLAG
01690      C   A1+2000,A2+2000,,COMPARE DATA
01700      CF  A1+1,,,        CLEAR FLAG
01710      BE  *+48,,,        BRCH IF EQUAL
01720      TFM ERR+18,K6,,    LOAD RETURN
01730      TFM E1+6,ER6,,     LOAD ERROR T/O
01740      BTM ETO,ER7,,      BRCH LOAD ER T/O
01750      CM  S1+5,19580,,   COMPARE TO DONE
01760      BE  *+48,,,        BRCH IF
01770      AM  S1+5,20,,      UPDATE
01780      AM  S2+5,20,,      UPDATE
01790      B   K6-24,,,       LOOP BACK
01800*
01810*         TEST COMPLETE ROUTINES
01820*
01830      BC4 K2+12,,,       SW4 ON LOOP BK
01840      BNC1*+48,,,        SW 1 OFF BYPASS
01850      BNR *+36,ERM,,     CK FOR RM IN MAP
01860      RCTY,,,            RETURN CARRIAGE
01870      WATYER30,,,        TYPE ER OCCURRED
01880      RCTY,,,            RETURN CARRIAGE
01890      WATYT10,,,         TEST COMPLETED
01900      RCTY,,,            RETURNCARRIAGE
01910      H   ,,,            HALT
01920      TFM STA+6,STA+12,, LOAD RESTART
01930      B   STA,,,         RESTART TEST
01940*
01950*         ERROR SUBROUTINE
01960*
01970ERR   BI  *+24,01900,,   ANY DATA CHECK
01980      B   99999,,,       RETURN TO PROG
01990      BNI J10,03900,,    ANY FILE CHECK
02000      BNI BYSL,03600,,   ADDRESS CHECK
02010      CM  E1+6,ER8,,     WAS OP A SEEK
02020      BNE *+36,,,        BRCH - NO
02030      TFM E1+1,41,10,    CHANG WATY TO NOP
02040      BTM ETO,ER19,,     BRCH LOAD ER T/O
02050      BTM ETO,ER10,,     BRCH LOAD ER T/O
02060BYSL  BNI *+24,03700,,   RECORD LENGTH CK
02070      BTM ETO,ER11,,     BRCH,LOAD ER T/O
02080      BNI *+24,03800,,   OVERFLOW CHECK
02090      BTM ETO,ER12,,     BRCH,LOAD ER T/O
02100      BTM ETO,ER13,,     BRCH,LOAD ER T/O
02110J10   BNI *+24,00600,,   READ CHECK
02120      BTM ETO,ER14,,     BRCH,LOAD ER T/O
02130      BNI *+24,00700,,   WRITE CHECK
02140      BTM ETO,ER15,,     BRCH,LOAD ER T/O
02150      BNI *+24,01600,,   MBR-E CHECK
02160      BTM ETO,ER16,,     BRCH,LOAD ER T/O
02170      BNI *+24,01700,,   MBR-O CHECK
02180      BTM ETO,ER17,,     BRCH,LOAD ER T/O
02190      BI  *+12,0800,,    MAR CHECK
02200      BI  *+12,02100,,   TAS CHECK
02210      BI  *+12,02200,,   F R CHECK
02220      BI  *+12,02300,,   A O CHECK
02230      B   ERR,,,         LOOP BACK
02240*
02250*         ERROR TYPE OUT ROUTINE
02260*
02270      NOP ,,,            NO OPERATION
02280ETO   BC1 J11,,,         SW 1 ON BYPASS
02290      MM  S1+5,05,10,    MULTIPLY
02300      TD  ER20+10,95,,   CYL. NUMBER
02310      TD  ER20+12,96,,   CYL. NUMBER
02320      TD  ER20+24,97,,   HD NUMBER
02330      TF  E1+18,ETO-1,,  LOAD ER TO/O
02340      RCTY,,,            RETURN CARRIAGE
02350E1    WATY99999,,,       TYPE ERROR
02360      WATY99999,,,       TYPE ERROR
02370      WATYER20,,,        TYPE ERROR
02380J11   TD  ERM,RM,,       PUT RM IN MAP
02390      TR  00100,TAB,,    REPLACE MATH TAB
02400      TFM E1+1,39,10,    CHANG NOP TO WATY
02410      BNC3*+24,,,        SW3 ON HALT
02420      H   ,,,            HALT
02430      B   ERR,,,         SEE IF MORE ERS
02440*
02450*         DATA,TYPE OUTS,ERROR
02460*         MESSAGES AND CONSTANTS
02470*
02480T1    DAC 28,DT 0021 - TEST DATA PROGRAM@
02490T4    DAC 16,SWITCH SETTINGS@
02500T5    DAC 21,PROGRAM - AS DESIRED@
02510T6    DAC 11,DATA--PROG@
02520T7    DAC 25,KEY IN 1 DIGIT MODULE NUM
02530      DAC 05,BER @
02540T10   DAC 15,TEST COMPLETED@
02550T20   DAC 24,DISK PACK ON 1311 IS NOT
02560      DAC 23, C E DISK PACK DONT USE
02570      DAC 10, PROGRAM.@
02580T30   DAC 22,SW 3 ON FOR CORRECTING
02590      DAC 08, KEY IN@
02600*
02610*         ERROR MESSAGES
02620*
02630ER3   DAC 14,WRITE 20 SCT @
02640ER4   DAC 14,READ BK COMP @
02650ER5   DAC 14,READ 20 SCTR @
02660ER6   DAC 14,PROG COMPARE @
02670ER7   DAC 15,DATA NOT EQUAL@
02680ER8   DAC 06,SEEK @
02690ER10  DAC 14, ADS CK (36) @
02700ER11  DAC 14, WLR CK (37) @
02710ER12  DAC 15, OVFO CK (38) @
02720ER13  DAC 19, FILE NO IND (39) @
02730ER14  DAC 13, RD CK (06) @
02740ER15  DAC 13, WR CK (07) @
02750ER16  DAC 13, MBR-E (16) @
02760ER17  DAC 13, MBR-O (17) @
02770ER19  DAC 14,SELECT LOCK  @
02780ER20  DAC 14, CYL 99  HD 9@
02790ER30  DAC 23,ERROR OCCURRED BUT SW 1
02800      DAC 21, WAS ON THUS NO ETO.@
02810ER22  DAC 27,ACCESS ARM AT 99 SHD BE 97@
02820*
02830*         DATA,CONSTANTS,WORKING
02840*         AREA AND SUB-INSTRUCTIONS
02850*
02860TD    DSC 20,00000000001111111111
02870      DSC 20,22222222223333333333
02880      DSC 20,44444444445555555555
02890      DSC 20,66666666667777777777
02900      DSC 20,88888888889999999999
02910TAB   DSC 2,0
02920      DSB 100,3,,        MATH TABLES
02930N     DC  2,00,,         MODULE
02940      DC  2,00,,         BUFFER
02950M     DC  2,00,,         MODULE NO.
02960      DC  2,00,,         BUFFER
02970RM    DC  2,0@,,         RECORD MARK
02980CEM   DC  2,00,,         C E MAP
02990ERM   DC  2,00,,         ERROR MAP
03000GM    DC  1,@,,          GROUP MARK
03010      DAC 1,0
03020S1    DSC 9,000000020,,  SUB-INST
03030      DSA A1+1
03040S2    DSC 9,000000020,,  SUB-INST
03050      DSA A2+1
03060S3    DSC 9,000000001,,  SUB-INST
03070      DSA A3+1
03080CC    DC  5,06840,,      CK CYL
03090      DC  5,07080,,      CK CYL
03100      DC  5,07320,,      CK CYL
03110      DC  5,19960,,      CK CYL
03120      DAC 1,0
03130A1    DC  2,00,,         LABEL
03140      DSB 20,100,,       DATA AREA
03150A2    DC  2,00,,         LABEL
03160      DSB 20,100,,       DATA AREA
03170A3    DC  2,00,,         LABEL
03180      DSB 20,100,,       DATA AREA
     MON   DS  ,18117
     MONIT DS  ,18000
12345      DAC 04,DT21
12345      DSA LAST
     DIPAL BNR DIPAL6      ,MON
           B   *+48
12345      NOP K2+12,,,
12345      TDM *-11,9,,
           B   STA
           TF  ERR-12*10+6,DIPAL1+6
           B   MONIT
     DIPAL1B   DIPAL2,,0
     DIPAL2BNR *+24,MON
           B   MONIT
           BNC1ERR-12*6
           B   ERR-12*9
     DIPAL6H   
           B   STA
12345LAST  DC  01,0,,
07970      DENDDIPAL
